Cryptanalysis of an Enhanced Sub-image Encryption 
Method 
Ruisong Ye 
Department of Mathematics, Shantou University 
Shantou, Guangdong, 515063, China 
E-mail: rsye@stu.edu.cn Junming Ma 
Department of Mathematics, Shantou University 
Shantou, Guangdong, 515063, China 
 
 
ABSTRACT  
The paper presents a cryptanalysis of an enhanced sub-image 
encryption method recently proposed by Wang et al. in Optics 
and Lasers in Engineering 86(2016). Their paper shows that a 
parallel sub-image encryption method proposed by Mirzaei et al. 
in Nonlinear Dyn. 67(2012) could be attacked by chosen plaintext 
attack and proposed an enhanced sub-image encryption method 
claimed to completely resist the chosen plaintext attack. However, 
the enhanced sub-image encryption method also has som e 
weakness, such as the key streams are independent with the plain-
image. In this paper , one chosen plaintext attack type of 
cryptanalysis is presented for the enhanced sub-image encryption 
method and completely broken the enhanced sub-image 
encryption met hod. The experimental results indicate that the 
enhanced sub-image encryption method is weak against chosen 
plaintext attack and should be improved for practical application. 
CCS Concepts 
• Security and privacy ➝ Cryptanalysis and other attacks  
Keywords  
image encryption; cryptanalysis; chosen plaintext attack; chaotic 
system 
1. INTRODUCTION 
With the rapid development of information communication, the 
secure transmission of images has become more and more 
important and image encryption methods have attracted many 
scholars in both research and application fields. Due to some 
intrinsic features of images such as bulk data capacity and high 
correlation among pixels, chaos-based encryption methods have 
been considered as a favorable way for image encryptions because 
of its strong sensitivity to the initial values and parameters, the 
unpredictability of long-term evolution, easy producing pseudo-
random sequences and other characteristics [1-4]. Most of the 
chaos-based image encryption schemes apply a permutation-
diffusion architecture initially presented by Fridrich in 1998 [1]. I n 
such a typical chaos-based image encryption scheme, one encryption round including  confusion stage and diffusion stage is 
performed generally. In the permutation stage, two-dimensional 
chaotic systems are usually used to scramble the pixels ’ positions , 
while in the diffusion stage the values of all pixels are 
systematically modified, which is controlled by one pseudo-
random gray value sequence generated by one chaotic map. A n 
ideal encryption scheme should possess some fundamental 
requirements. It should be sensitive enough to cipher keys; the key 
space should be large enough to resist brute-force attack; the 
permutation and diffusion processes should possess good statistical 
properties to frustrate statistical attack, differential attack, known-
plaintext attack and chosen-plaintext attack, etc. However, the 
traditional permutation-diffusion architecture with fixed key 
streams is blamed for one fatal flaw. The permutation and 
diffusion processes will be independent if the plain-image is a 
homogeneous one with identical pixel gray value. Therefore, such 
a kind of image encryption schemes can be attacked by the 
following steps: (a) a homogeneous image with identical pixel 
gray value is employed to eliminate the confusion effect; (b) the 
key streams of the diffusion process can be acquired by using 
known-plaintext, chosen-plaintext or chosen-ciphertext attacks; (c ) 
the remaining cipher-image can be regarded as the output of a kind 
of permutation-only cipher, which has been verified vulnerable to 
known-plaintext or chosen plaintext attacks [5 , 6]. As a matter of 
fact, image encryption schemes with conventional permutation-
diffusion architecture have been analyzed or shown to suffer from 
security drawbacks because their key streams are independent with 
the plaintext [7- 10]. 
Recently, a new image encryption scheme based on a total 
shuffling and parallel encryption algorithm is proposed by Mirzaei 
et al. [11].  In the parallel sub-image encryption scheme, the plain-
image is decomposed to 4 sub-images with equal size and then the 
position of each sub­ image is changed pseudo-randomly according 
to one Logistic map. Next, a total shuffling matrix is used to 
shuffle the position of pixels in the whole image and then sub-
images are encrypted  simultaneously  in a parallel manner. 
However, Wang et al. show that there are three fatal flaws in the 
proposed parallel sub-image encryption algorithm. (i) The division 
of plain-image into sub-images  and the shuffling of sub-images 
before  the  total  shuffling  process only depend on Logistic map. 
(ii) The total shuffling process solely depends on Logistic map. ( iii) 
The  order changing the pixel values is ordered sequentially 
without  concerning the contents of  plain-image.  Based on these 
defects, Wang et al. show that the method proposed by Mirzaei et 
al. in [11] can be broken  by chosen  plaintext attack and then 
propose an enhanced sub-image algorithm to resist the chosen  
plaintext  attack and reduce the encryption time dramatically [ 12]. 
The contributions of the work by Wang et al. are that they provide 
dynamical pixel order for diffusion and sub-images division 
method. Unfortunately, the enhanced sub-image encryption 
method also solely depends on the secret keys and is not actuall y 
related to the plain-image as well. Therefore the enhance  sub-Permission to make digital or hard copies of all or part of this work for 
personal or classroom use is granted without fee provided that copies are 
not made or distributed for profit or commercial advantage and that 
copies bear this notice and the full citation on the first page. Copyrights 
for components of this work owned by others than ACM must be 
honored. Abstracting with credit is permitted. To copy otherwise, or 
republ ish, to post on servers or to redistribute to lists, requires prior 
specific permission and/or a fee. Request permissions from 
Permissions@acm.org.  
ICMIP 2018, March 16 -18, 201 8, Guiyang, China  
© 201 8 Association for Computing Machinery.  
ACM ISBN 978-1-4503-6468 -3/18/03 …$15.00  
DOI: https://doi.org/ 10.1145/3195588.3195602  
57image encryption method has not overcome the problem that the 
key streams are independent with the plaintext. In this paper, a 
chosen plaintext attack has been successfully performed on the 
enhanced sub-image encryption method, which actually cannot 
resist the chosen plaintext attack. 
The rest of this paper is organized as follows. Section II briefly 
describes the enhanced sub-image encryption method proposed by 
Wang et al. [12]. Section III elaborates the cryptanalysis of the 
enhanced encryption method. Section IV gives the experimental 
results and Section V concludes the paper.  
2. THE ENHANCED S UB-IMAGE 
ENCRYPTION METHOD 
In the enhanced sub-image encryption method proposed by Wang 
et al. [12] , the permutation –diffusion architecture is applied . 
Based on the total shuffling approach presented in [11], Wang et 
al. firstly divided the plain image into four sub-images and then 
used chaotic Logistic map and initial condition 
0x  to generate 
four chaotic matric es in the permutation process which were used 
to shuffle each sub-image respectively and then conduct ed the 
total shuffling to the whole image. Though the permutation 
process proposed in [12] is more completed than that in [11], it 
also solely depends on Logistic map. In the diffusion process, 
three chaotic system s have been used in both [11] and [12] . 
Logistic chaotic system is the first one which can be described by 
(see [13]) 
14 1- .n n nx x x
  
The second one, Lorenz system is described by 
1 2 1
2 1 3 1 2
3 1 2 3( ),
,
,x p x x
x x x rx x
x x x tx
  

 
where 
,pr and 
t are parameters and the system is chaotic 
when
 10, 28, 8 / 3p r t   [14]. The last chaotic system is 
Chen’s  chaotic system, which is described as follows. 
4 5 4
5 4 4 6 5
6 4 5 6( ),
( ) ,
,x a x x
x c a x x x cx
x x x bx
   

 
where 
,ab and 
c are parameters and the system is chaotic when 
35, 3ab
 and 
28c  [15]. 
Lorenz system and Chen ’s system are all employed to calculate 
{ , 1,2,3,4}
ixBi
  for the diffusion process. And the diffusion 
process is almost the same as that in [11] except for the order 
changing the pixel value. For example, if one obtains a pseudo-
random array of {3,1,4,2}, then change the corresponding pixel in 
the order of sub-image 3, sub-image 1, sub-image 4 and sub-
image 2 using the following equations: 
1
2
3
44 3 4 3 4 2
/2, /2, , /2
4 1 4 1 4 3
, , /2,
4 4 4 4 4 1
/2, /2 /2, /2 ,
4 2 4 2 4 4
, /2 , /2 /2, /2( ) ,
( ) ,
( ) ,
( ) .k k k
i M j i M j x i j N
k k k
i j i j x i M j
k k k
i M j N i M j N x i j
k k k
i j N i j N x i M j NC B B C
C B B C
C B B C
C B B C  
  
  

  
   
  
     
  
  
  
 The symbol “
” represents the bitwise exclusive OR operation. 
4
,( 1,2,3,4)km
ijCm
 represents the ciphered pixel value at 
( , )ij
-pixel of sub-image 
m , 
k represents the 
(1)k  -th 
iteration of the two chaotic systems   in [12] and 
4
,( 1,2,3,4)km
ijBm
 represents the plaintext pixel value at 
( , )ij
-pixel of sub-image 
m . The detailed encryption process is 
described as follows. 
1) Using Logistic map with initial condition 
0x , divide the plain 
image into four sub-images, follow the total shuffling according 
to Ref. [11] to the four sub-images respectively. Then conduct the 
total shuffling to the whole image. 
2) Shuffle the sub-images using the current 
0x and Logistic map 
according to Ref. [11].  
3) The diffusion process is almost the same as in Ref. [11] except 
for the order changing the pixel value. Every four times of 
iterations the Logistic map uses another initial value 
00x  to 
generate a pseudo-random array as Ref. [11]. The pseudo­ random 
array determines the order of changing pixels. For example, if a 
pseudo-random array of {3, 1, 4, 2}is generated, change the 
corresponding pixel in the order of sub-image 3, sub-image 1, 
sub-image 4 and sub-image 2. 
Note that the most important part of the enhanced encryption 
method is to increase a new pseudo-random array in the diffusion 
part which can change the order of using each of sub-images. 
However, the enhanced method has not solved a very significant 
problem which is also mentioned in [12] that the diffusion 
process is not depending on contents of the plaintext image. 
Please refer to [11] for the detailed encryption scheme proposed 
therein. 
3. CRYPTANALYSIS OF THE ENHANCED 
ENCRYPTION METHOD 
According to the Kerckhoffs ’s principle [16], there is a general 
assumption that cryptanalyst can have all information about the 
encryption algorithm except the secret keys for the encryption and 
decryption. And chosen plaintext attack, which means attackers 
can choose some plaintexts and get the corresponding ciphertexts, 
is often used to cryptanalyze encryption algorithms. Although the 
secret keys are unknown, one can find the equivalent key streams 
that can reveal ciphertexts well without secret keys. Therefore, 
the original algorithm can be cracked if it cannot resist chosen 
plaintext attack. 
Assume that the dimension of the plaintext 
I is 
MN . 
Pis the 
obtained image after permutation. 
C  is the ciphertext after 
permutation and diffusion and the position matrix of pixels is 
, , 1,2, , ; 1,2, ,I i j i M j N   
. 
A. The Equivalent Secret Key Streams 
The equivalent secret keys consist of two parts. O ne part is used 
in the permutation process and the other is used in the diffusion 
process . They are described and revealed respectively as follows. 
i) The equivalent secret key streams of permutation process. 
Permutation process is performed b y transforming pixel positions 
58to their transformed positions. No matter how complicated is the 
permutation of the encryption algorithm, it can be expressed by  
( ( ), ( )) ( , ), 1,2,..., ; 1,2,..., ,P lx i ly j I i j i M j N   
 
where 
lx  and 
ly are row permutation array and column 
permutation array. After permutation,
( , )I i j will move to 
( ( ), ( ))P lx i ly j
 but not modify its pixel value. Once the attackers 
obtain 
lx and 
ly , the permutation will be broken and it is actually 
useless. Therefore, one can assume the equivalent secret key 
streams of the permutation are 
lx  and 
ly . 
ii) The equivalent secret key streams of diffusion process.  
Diffusion process is a process to alter pixel values which can 
overcome the permutation ’s shortage. Sequence 
{}
ixB  in the 
proposed image encryption algorithm in [12] is one part of the 
equivalent key streams. There is another equivalent key stream in 
[12], that is the new pseudo-random array which determines the 
order of changing pixels in the diffusion process. Here the new 
array plays a significant role for the enhanced method.  Therefore, 
one  has two equivalent secret key streams, sequence 
{}
ixB  and 
pseudo-random order array, which are used to crack the enhanced 
sub-image encryption method. 
B. Revealing the Equivalent Secret Key 
streams 
Firstly, choose black image 
0I  with all pixel values being zero. 
Assume that the corresponding permut ed image is 
0P  and the 
cipher image is 
0C . Obviously, one gets
00PI . Secondly, 
choose 
MN images 
,{ , 1,2, , ; 1,2, , }ijI i M j N   
,  
where 
,ijI has only one pixel 
,( , )ijI i j  with value 1 and the other 
pixels ’ values equal to 0. Using their cipher images 
,ijC  to 
generate a new cell
,ijXor  using the following operation: 
, , 0 .i j i jXor C C
 
Then use matrix 
CT  to store the sum of all the elements of each 
matrix 
,ijXor  which can be described by 
,
11( , ) ( , )MN
ij
klCT i j Xor k l

. 
The data obtained are used to reveal the equivalent secret key 
streams by Step1-Step 2. 
Step 1.  Based on the assumptions mentioned above, 
( 1, 1)I i j  is 
transform ed to 
( ( 1), ( 1))P lx i ly j  after permutation. Suppose 
( ( 1), ( 1))P lx i ly j
 is the first pixel to be encrypted in the diffusion, 
then the pixels of 
1, 1ijXor  should all be one and 
( 1, 1)CT i j M N
. The second encrypted pixel 
( ( 2), ( 2))P lx i ly j
 in the diffusion should satisfy 
 2 2 -1 CT i j M N ，
. And the last encrypted pixel 
( ( ), ( ))P lx iM ly jN
 should be 
( , ) 1CT iM jN  . So far, there is no idea about where is the position of the 
encrypted pixel because of the pseudo-random order array , so 
lx  
and 
ly cannot be recovered directly right now. However, one can 
realize that the order array in the diffusion is the order of using 
four sub-images one by one. For example, the first time of 
iterations in the diffusion should be the element of 
{ (1,1), (1 / 2,1), (1,1 / 2), (1 / 2,1 / 2)}P P M P N P M N   
.  
Then one can firstly reveal the fourth encrypted pixel which must 
satisfy the following two conditions: 
(1a) The corresponding value of matrix 
CT , represented by 
( 4, 4)CT i j
, is 
-3 MN . 
(2a) The corresponding value of 
, {}ijXor , represented 
by
4, 4( , )ijXor i j , is equal to 1 and 
( , )P i j  is the element of 
{ (1,1), (1 / 2,1), (1,1 / 2), (1 / 2,1 / 2)}P P M P N P M N   
. 
Without loss of generality, assume that 
(1,1)P  is the fourth 
encrypted pixel that is transformed from 
( 4, 4)I i j , meaning 
( 4) 1lx i
 and 
( 4) 1ly j . Then one can decide the third 
encrypted pixel which must satisfy the following two conditions: 
(1b) The corresponding value of matrix 
CT , represented by 
( 3, 3)CT i j
, is
-2 MN . 
(2b) The corresponding value of 
, {}ijXor , represented 
by
4, 4( , )ijXor i j  , is equal to 1 and 
( , )P i j  is the element of 
{ (1,1), (1 / 2,1), (1,1 / 2), (1 / 2,1 / 2)}P P M P N P M N   
. 
Following this way, one can reveal the first pseudo-random order 
array and some values of 
lx  and 
ly . Finally the whole pseudo-
random order array 
lx  and 
ly can be revealed after analyzing all 
iterations.  
Step 2. Up to now, most part of the equivalent secret key streams 
have been revealed, the last thing one needs to focus on is the 
sequence 
{}
ixB . According to [12] , the permutation process will 
be transparent and invalid when choosing the image with all pixel 
values of zero. Since the pseudo-random array in Step 1 has been 
revealed , one can get the corresponding part of sequence 
{}
ixB . 
Although the secret keys are unknown, one can use the equivalent 
key streams to reveal the encrypted image. Therefore, the original 
algorithm in [12] cannot actually resist against chosen plaintext 
attack. 
4. EXPERIMENTAL RESULTS  
In this section, the authors will carry out some experiments to 
demonstrate the proposed cryptanalysis . For the sake of lower 
computational complexity , the authors  would like to use a 
randomly 
88  matrix instead of the whole image. The cipher 
keys are the same as those in [12], 
0 00 1 2 3
4 5 6 0 00.123456, 0.7654321, 0.3, 0.4, 1.2,
10.2, 3.5, 4.4, 500, 500.x x x x x
x x x N M    
    
  
 Firstly, suppose our randomly plaintext produced by Matlab is 
59173 25 126 7 206 250 133 249
101 67 199 190 147 182 24 166
94 85 183 128 46 128 209 204
252 174 231 122 61 120 209 116=.9 34 228 231 226 15 184 110
226 184 85 156 7 174 38 211
233 27 178 158 125 10 168 21
203 167 50 220 42 18 132 34I










 
The corresponding ciphertext is 
100 39 232 165 144 197 29 59
215 249 4 198 217 104 4 7
233 32 133 211 120 126 89 75
208 32 251 20 142 156 58 74=252 97 123 53 121 156 187 127
114 175 77 80 216 111 235 64
91 120 126 187 59 223 119 145
19 194 182 248 134 179 38 134C











. 
According to the operations stated in Section III, one gets  
(3,1) 61, (3,3) 64,
(6,1) 63, (6,3) 62.CT CT
CT CT

 
So it is know n about that 
(3,3)I is the first pixel to be encrypted 
in the diffusion, but it is not sure which element of 
{ (1,1), (1,5), (5,1), (5 5 },) P P P P
it has transformed to.  Look at 
the corresponding matrix 
3,3Xor : 
3,311111111
11111111
11111111
11111111=11111111
11111111
11111111
11111111Xor











.
 
In this case, there is no idea about how to crack. However, one 
can use reverse thinking and try to crack the last pixel rather than 
the first one. Following the matrix
3,1Xor below, one can easily 
deduce that 
(1,1)P is the last pixel to be encrypted. Therefore 
(3,1)I
will be transformed to 
(1,1)P  firstly and then encrypted 
at the last moment in the diffusion.  
3,11 1 1 1 0 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1=0 1 1 1 0 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1Xor










.
 
The remaining two matric es are  
6,11 1 1 1 0 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1=,1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1Xor











6,31 1 1 1 0 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1=.0 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1Xor











 
Using the same method, one can obtain the results in Table I a nd 
(3) 1, (6) 5, (1) 1, (3) 5.lx lx ly ly   
 
Table 1. Deduced Results for Four Positions. 
Original 
position  Encrypted order  in 
diffusion  Position after 
permutation  
I(3,1)  4 P(1,1)  
I(6,3)  3 P(5,5)  
I(6,1)  2 P(5,1)  
I(3,3)  1 P(1,5)  
Finally, the equivalent secret keys of the permutation and the 
cracked image are 
 
 3 4 1 8 6 5 7 2 ,
1 8 5 2 6 3 4 7 ,
173 25 126 7 206 250 133 249
101 67 199 190 147 182 24 166
94 85 183 128 46 128 209 204
252 174 231 122 61 120 209 116=9 34 228 231 226 15 184 110
226 184 85 156 7 174 38 211
233 27 178 158 125 10 168 21
203 167 50 220 42 18 132 34lx
ly
CI





,










 
 
60where 
CI I  meaning the proposed chosen plaintext attack 
successfully broke the enhanced sub-image encryption method. 
Therefore it is not secure enough and cannot be used in practical 
communication. The simulation is performed on plain-image 
Lena. The experimental results are shown in Fig. 1. The cipher 
image is completely broken by chosen plaintext attack and the 
decrypted image is the same as the plain-image. 
 
(a) 
 
(b) 
 
(c) 
Figure 1. Experimental results. (a) plain-image Lena; (b) 
cipher-image; (c) decrypted image without using cipher key. 
5. CONCLUSIONS 
In this paper,  an enhanced sub-image image encryption method 
proposed proposed by Wang et al in [12] is cla imed  that it can 
completely resist the chosen plaintext attack. However, the study 
in this paper shows that it is not true . The authors firstly find out 
that th e the key streams of the enhanced sub-image encryption 
method is not related to the content of plain-image, which is a key 
point for possible cryptanalysis . Secondly, reverse thinking helps 
us to solve the problem when facing different encrypt orders in the 
diffusion. Therefore the security of the enhanced sub-image 
encryption method proposed in [12] is fragile and cannot be 
applied in practical cryptosystem. To improve the robustness 
resisting chosen plaintext attack, one can design some encryption 
schemes using  keystreams related to the contents of plain-image 
and achieve the effect of one-time pad . The improvement of the 
enhance sub-image encryption method can be exploited in the 
future work.     6. ACKNOWLEDGMENT 
This research is supported by National Natural Science Foundation 
of China (No. 11271238). 
7. REFERENCES  
[1] J. Fridrich, “Symmetric ciphers base d on two-dimensional 
chaotic maps”, International Journal of Bifurcation and 
Chaos, 8(1998),  1259-1284. 
[2] S. Lian, J. Sun, Z. Wang, “A block cipher based on a suitable 
use of the chaotic standard map ”, Chaos, Solitons and 
Fractals, 26:1(2005),  117-129. 
[3] N. K. Pareek, V. Patidar, K. K. Sud. “Discrete chaotic 
cryptography using external key ”, Phys. Lett. A, 309:1(2003), 
75-82. 
[4] R. Ye, “A novel chaos-based image encryption scheme with 
an efficient permutation-diffusion mechanism ”, Optics 
Communications, 284(2011),  5290-5298. 
[5] C. Q. Li, S. J. Li, G. R. Chen, G. Chen, L. Hu, 
“Cryptanalysis of a new signal security system for 
multimedia data transmission”, EURASIP J. Appl. Signal 
Process., 8(2005), 1277-1288. 
[6] S. J. Li, C. Q. Li, G. R. Chen, N. G. Bourbakis, K. T. Lo , “A 
general quantitative cryptanalysis of permutation-only 
multimedia ciphers against plain-image attacks”, Signal 
Process. Image Commun., 23(2009), 212-223. 
[7] E. Solak, R. Rhouma, S. Belghith. “Cryptanalysis of a multi-
chaotic systems based image cryptosystem ”, Optics 
Communications , 282(2010),  232 –236. 
[8] D. Arroyo, C. Q. Li, S. J. Li, G. Alvarez, W.A. Halang. 
“Cryptanalysis of an image encryption scheme based on a 
new total shuffling algorithm ”, Chaos, Solitons and Fractals, 
41:5(2009), 2613-2616. 
[9] R. Bechik, H. Hermassi, Ahmed A, Abd El-Latif, “Breaking 
an image encryption scheme based on a spatiotemporal 
chaotic system” , Signal Processing: Image Communication, 
39(2015 ), 151-158. 
[10] E. Y. Xie, C. Li, S. Yu, et al. “On the cryptanalysis of 
Fridrich's chaotic image encryption scheme ”, Signal 
Processing, 132(2016), 150-154. 
[11] O. Mirzaei, M. Yaghoobi, H. Irani. “A new image 
encryption method: parallel sub-image encryption with hyper 
chaos ”, Nonlinear Dyn. 67(2012). 
[12] X. Wang, Y. Zhang, L. Liu. “An enhanced sub-image 
encryption method ”,  Optics and Lasers in Engineering , 
86(2016), 248-254. 
[13] R. M. May, “Simple mathematical models with very 
complicated dynamics ”, Nature, 261(1976), 459-467. 
[14] E. N. Lorenz, “Deterministic nonperiodic flow ”,  J. Atmos. 
Sci., 20(1963), 130-141. 
[15] G. R. Chen, T. Ueta, “Yet another chaotic attractor ”, Int. J. 
Bifurc. Chaos, 9(1999), 1465-1466. 
[16] D. R. Stinson, Cryptography: Theory and Practice, CRC 
Press, Boca Raton, 1995. 
61