Cryptanalysis of GiophantusTMSchemes against Hybrid Attack
Yuntao Wang
Graduate School of Information Science and Technology,
The University of Tokyo; Japan Society for the Promotion
of Science
y-wang@jaist.ac.jpYasuhiko Ikematsu
Institute of Mathematics for Industry, Kyushu University
ikematsu@imi.kyushu-u.ac.jp
Koichiro Akiyama
Toshiba Corporation R&D Center
koichiro.akiyama@toshiba.co.jpTsuyoshi Takagi
Graduate School of Information Science and Technology,
The University of Tokyo
takagi@mist.i.u-tokyo.ac.jp
ABSTRACT
The hybrid attack was proposed by Howgrave-Graham in CRYPTO2007,
which was originally designed for the cryptanalysis of NTRU cryp-
tosystems. In this paper, based on Howgrave-Grahamâ€™s attack model,
we propose a simulator of hybrid attack to evaluate the hardness of
the unique shortest vector problem. By a dynamical computation,
our algorithm can trade off the cost between reduction and MitM,
while both of them run in exponential time. Further, we adapt our
simulator to Giophantus.., Giophantus+and Giophantusâˆ’cryp-
tosystems, proposed by Akiyama et al. in SAC2017, SCIS2019 and
SCIS2020, respectively. Our analysis shows that by the hybrid attack,
the security levels can be reduced by at most 19 bits for Giophantusâ€™
parameters proposed in NIST Post Quantum Cryptography (PQC)
standardization 1st round submission. Meanwhile, the parameter
sets of Giophantus+and Giophantusâˆ’are secure against the hybrid
attack.
CCS CONCEPTS
â€¢Security and privacy â†’Cryptanalysis and other attacks .
KEYWORDS
lattice; cryptanalysis; hybrid attack simulator; unique shortest
vector problem; Giophantus.
ACM Reference Format:
Yuntao Wang, Yasuhiko Ikematsu, Koichiro Akiyama, and Tsuyoshi Takagi.
2020. Cryptanalysis of GiophantusTMSchemes against Hybrid Attack. In
Proceedings of the 7th ACM ASIA Public-Key Cryptography Workshop (APKC
â€™20), October 6, 2020, Taipei, Taiwan. ACM, New York, NY, USA, 8 pages.
https://doi.org/10.1145/3384940.3388958
1 INTRODUCTION
Under the threat of Shorâ€™s quantum algorithm to current public key
cryptoschemes (e.g. RSA, ECC, DH, etc.), the development of post-
quantum cryptography (PQC) is undoubtedly trending research
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
APKC â€™20, October 6, 2020, Taipei, Taiwan
Â©2020 Association for Computing Machinery.
ACM ISBN 978-1-4503-7607-5/20/10. . . $15.00
https://doi.org/10.1145/3384940.3388958topic in the crypto world. NIST takes the lead of standardization
for PQC in 2017, and many proposals are under evaluation [ 1].
Thereinto, the lattice-based cryptoschemes are considered to be the
most compelling candidates due to their elegant designs and flex-
ible parameter settings. Most of the mathematical hard problems
underlying these lattice-based cryptoschemes are the well-known
learning with errors (LWE) problem, the ring learning with er-
rors (RLWE) and their variants [ 17,18]. Practical and theoretical
cryptanalysis are required for evaluating the parameter sets there.
Howgrave-Graham [ 14] proposed the hybrid attack to re-estimate
the security of NTRU cryptoscheme in 2007. It hybridizes a lat-
tice reduction algorithm and the Meet-in-the-Middle (MitM) attack
and outperforms either of the two attacks separately. Therefore,
a number of lattice-based cryptoschemes use the hybrid attack
when evaluating their parameters. Since then, the hybrid attack is
considered to be one of the most efficient attacks to lattice-based
cryptoschemes. However, since there are many parameters in the
hybrid attack and it is not easy to evaluate an optimal setting for
the hybrid attack, most of the cryptoschemes such as the NIST PQC
proposals [ 1] just mention the existence of this attack by a couple of
words or only give a rough estimation lacking any lucid simulator
(or say, an estimator).
In this work, we study the hybrid attack and propose its simu-
lator to evaluate the hardness of the unique shortest vector prob-
lem which generally can be reduced from the LWE problem, the
RLWE problem, NTRU, etc. Our simulator is based on the geometric
series assumption [ 19], the property of unchangeable lattice vol-
ume, and the so-called 2016 estimate [ 6]. As an example, we apply
our simulator to the lattice-based cryptoscheme Giophantus [ 3]
and its variants. The Giophantus schemes proposed to the first
round of NIST PQC standardization project, and the later versions
Giophantus+, Giophantusâˆ’are NTRU-like post-quantum cryptosys-
tems whose security depend on the problem of solving the indeter-
minate equations. The schemes have the potential to combine the
high encryption/decryption speed of lattice-based schemes with
the nonlinearity of multivariate schemes; nevertheless, the NIST
proposed version Giophantus are depending on the problem of
solving linear indeterminate equations. In practice, these schemes
reduce the probability of decoding failure to zero. As a result, the
key recovery problem is equivalent to a unique shortest vector prob-
lem that can be applied to the hybrid lattice attack due to finding
small solutions compared with the large modulus ğ‘.
Session 2
 
APKC '20, October 6, 2020, Taipei, Taiwan
281.1 Related Works
In 2007, Howgrave-Graham [ 14] proposed the idea of a hybrid at-
tack and showed its threat to NTRU schemes. Some subsequent
works are trying to improve the hybrid attack applicable to the
learning with errors (LWE) variants, or extending the distribution
of target vector rather than binary, etc. A theoretical analysis of
the hybrid attack was given in [ 12]. Furthermore, an application
of the hybrid attack to binary LWE was analyzed in [ 8]. About the
success probability, theoretical analysis with additional assumption
is given in [ 12] and [ 8] but lack of experimental verification. In ad-
dition, Wunderer [ 22] pointed out the overestimate of lattice-based
cryptosystems derived from the flawed analysis due to roughly
simplifying the assumptions in the hybrid attack. In that work, he
proposed a generalized model of hybrid attack on the bounded
distance decoding (BDD) problem. He also applied the algorithm
in cryptanalysis using two formulas of over- and underestimation
of the hybrid attackâ€™s complexity. Moreover, he gave a method to
construct lattice bases for trinary NTRU and various cases to be
used in the hybrid attack. A quantum version of the hybrid attack
was proposed in [ 11], where the MitM part is sped up by using a
generalization of Groverâ€™s quantum search algorithm. However,
the hybrid attack seems not considered or just roughly referred
among most candidates of the NIST Post Quantum Cryptography
(PQC) standardization project. To give a concrete evaluation for the
proposals, we need a feasible hybrid attack simulator.
1.2 Our Contribution
In this work, based on the Howgrave-Grahamâ€™s attack model in [ 14],
we propose a hybrid attack simulator on the unique Shortest Vector
Problem (uSVP). By a dynamical computation in the simulator, we
take account of the trade-off between the cost of lattice reduction
part and the cost of MitM, since both of them are exponential-time
algorithms with respect to the corresponding dimensions. Further,
we adapt our simulator on Giophantus [ 3], Giophantus+[16] and
Giophantusâˆ’[4] cryptoschemes, which are proposed by Akiyama
et al. The security of Giophantus, Giophantus+and Giophantusâˆ’
can be reduced to the hardness of the unique shortest vector prob-
lem by the key recovery attack. Using our proposed simulator of
hybrid attack, it shows that the security levels are reduced by at
most 19 bits for Giophantusâ€™ parameters proposed in NIST PQC
standardization 1st round submission. Meanwhile, the parameter
sets of Giophantus+and Giophantusâˆ’are secure against the hybrid
attack.
1.3 Roadmap
Section 2 covers notations and background. We recall the MitM
attack and the hybrid attack in Section 3. In Section 4 we propose
our simulator of the hybrid attack on uSVP. As an example, we
show the cryptanalysis results on Giophantus, Giophantus+and
Giophantusâˆ’. Finally, the conclusion is given in Section 5.
2 PRELIMINARIES
Notation. Letğ‘be a large prime number and ğ‘™,ğ‘›be two positive
integers.ğ‘™â‰ªğ‘is set in Giophantus schemes. Define the quotientring
ğ‘…âˆ’
ğ‘,ğ‘›:=Zğ‘[ğ‘¡]/(ğ‘¡ğ‘›âˆ’1)
for Giophantus and Giophantusâˆ’; define
ğ‘…+
ğ‘,ğ‘›:=Zğ‘[ğ‘¡]/(ğ‘¡ğ‘›+1)
for Giophantus+. The elements in Zğ‘are fromâŒŠâˆ’ğ‘/2âŒ‹+1toâŒŠğ‘/2âŒ‹.
For the sake of convenience, we simply represent the quotient ring
byğ‘…ğ‘,ğ‘›, unless it is necessary to distinguish in the context. We take
a full set of representatives of ğ‘…ğ‘,ğ‘›inZ[ğ‘¡]as follows:
Rğ‘,ğ‘›:=(ğ‘›âˆ’1Ã•
ğ‘˜=0ğ‘ğ‘˜ğ‘¡ğ‘˜ğ‘ğ‘˜âˆˆZğ‘)
,
and define
Rğ‘,ğ‘›[ğ‘¥,ğ‘¦]:=ï£±ï£´ï£´ ï£²
ï£´ï£´ï£³Ã•
ğ‘–,ğ‘—(ğ‘›âˆ’1Ã•
ğ‘˜=0ğ‘ğ‘–,ğ‘—,ğ‘˜ğ‘¡ğ‘˜)ğ‘¥ğ‘–ğ‘¦ğ‘—ğ‘ğ‘–,ğ‘—,ğ‘˜âˆˆZğ‘ï£¼ï£´ï£´ ï£½
ï£´ï£´ï£¾,
which is a full set of representatives of ğ‘…ğ‘,ğ‘›[ğ‘¥,ğ‘¦]inZ[ğ‘¡,ğ‘¥,ğ‘¦]. Simi-
larly, defineRğ‘™,ğ‘›andRğ‘™,ğ‘›[ğ‘¥,ğ‘¦]. For an element ğ‘“inRğ‘,ğ‘›[ğ‘¥,ğ‘¦], we
denote by degğ‘¡ğ‘“the degree of ğ‘“with respect to ğ‘¡. Also degğ‘¥,ğ‘¦ğ‘“
means the total degree of ğ‘“with respect to ğ‘¥,ğ‘¦. We denote a column
vector in bold lower case letters, e.g. vand represent a matrix of
column vectors in bold caps, e.g. B. Specifically, we represent the
coefficients of a polynomial by a vector type thereof. We sometimes
also combine two vectors by a space or return, e.g. combine vand
wby(vTwT)orv
w
.
2.1 Lattice
Alatticeğ¿âŠ‚Rğ‘šis generated by a set of linearly independent
vectors b1,..., bğ‘›inRğ‘š:ğ¿(b1,..., bğ‘›)={Ãğ‘›
ğ‘–=1ğ‘¥ğ‘–bğ‘–|ğ‘¥ğ‘–âˆˆZ}.
B=(b1,..., bğ‘›)forms a basis ofğ¿. The integers ğ‘›andğ‘šare called
therank and the dimension ofğ¿respectively. It is called a full-
rank lattice ifğ‘›=ğ‘š. We denote by ğœ†ğ‘–(ğ¿)the length of ğ‘–-th linear
independent shortest vector for ğ‘–=1,...,ğ‘› in a non-trivial lattice
ğ¿, e.g.ğ‘ â„ğ‘œğ‘Ÿğ‘¡ğ‘’ğ‘ ğ‘¡ ğ‘£ğ‘’ğ‘ğ‘¡ğ‘œğ‘Ÿ ofğ¿is one of the ğœ†1(ğ¿)-length vectors.
Gram-Schmidt Orthogonalization (GSO) . We denote by Bâˆ—=
(bâˆ—
1,..., bâˆ—ğ‘›)the associated Gram-Schmidt orthogonal basis of the
given lattice basis B=(b1,..., bğ‘›). The GSO components can be
computed by bâˆ—
1=b1,bâˆ—
ğ‘–=bğ‘–âˆ’Ãğ‘–âˆ’1
ğ‘—=1ğœ‡ğ‘–ğ‘—bâˆ—
ğ‘—for2â‰¤ğ‘–â‰¤ğ‘›where
ğœ‡ğ‘–ğ‘—=âŸ¨bğ‘–,bâˆ—
ğ‘—âŸ©
âˆ¥bâˆ—
ğ‘—âˆ¥2,1â‰¤ğ‘—<ğ‘–â‰¤ğ‘›. Define the orthogonal projection
ğœ‹ğ‘–:Rğ‘›â†’ğ‘ ğ‘ğ‘ğ‘›(b1,..., bğ‘–âˆ’1)âŠ¥. Thus, we have ğœ‹ğ‘–(bğ‘˜)=bğ‘˜âˆ’Ãğ‘–âˆ’1
ğ‘—=1ğœ‡ğ‘–ğ‘—bâˆ—
ğ‘—,1â‰¤ğ‘—<ğ‘–â‰¤ğ‘˜â‰¤ğ‘›. Furthermore, denote by ğœ‹ğ‘–(ğ¿)a
lattice generated by the basis (ğœ‹ğ‘–(bğ‘–),ğœ‹ğ‘–(bğ‘–+1),...,ğœ‹ğ‘–(bğ‘›)).
The fundamental domain ofğ¿corresponding to Bis the set
F(b1,..., bğ‘›)={ğ‘¡1b1+ğ‘¡2b2+Â·Â·Â·+ğ‘¡ğ‘›bğ‘›: 0â‰¤ğ‘¡ğ‘–<1}. The
volume (ordeterminant) of a lattice ğ¿is the volume ofF(B), which
is denoted by vol( ğ¿) (or det(ğ¿)) and can be calculated by det(ğ¿)=p
det(BâŠ¤B)=Ãğ‘›
ğ‘–=1âˆ¥bâˆ—
ğ‘–âˆ¥. Note that all the bases of ğ¿have the same
numberğ‘›of elements, and all their fundamental domains have the
same volume.
ğ‘-ary Lattice. A latticeğ¿âŠ‚Zğ‘šis called ağ‘-ary lattice if ğ‘Zğ‘šâŠ‚ğ¿
for an integer ğ‘. Let AâˆˆZğ‘›Ã—ğ‘šğ‘(ğ‘šâ‰¥ğ‘›)be a matrix, we define the
Session 2
 
APKC '20, October 6, 2020, Taipei, Taiwan
29ğ‘š-dimensional ğ‘-ary lattice as
ğ¿âŠ¥
(A,ğ‘)={xâˆˆZğ‘š|Axâ‰¡0(modğ‘)}.
It is clearly generated by the kernel ğ¾ğ‘’ğ‘Ÿ(A)ofAmodğ‘with
vol(ğ¿âŠ¥
(A,ğ‘))=ğ‘ğ‘›.
Gaussian Heuristic . The Gaussian Heuristic can estimate the num-
ber of points in ğ‘†âˆ©ğ¿approximately vol( ğ‘†)/vol(ğ¿), for a given lattice
ğ¿and a continuous subset ğ‘†âŠ‚Rğ‘›.
In particular, if ğ‘†is a origin-centred ball of radius ğ‘…, the number
of joint lattice points is ğ‘‰ğ‘›(ğ‘…)/vol(ğ¿). Thus the length ğœ†1of the
shortest vector can be estimated by:
ğœ†1(ğ¿)â‰ˆ(Î“(ğ‘›/2+1)vol(ğ¿))1/ğ‘›
âˆšğœ‹,
where the gamma function ğ›¤(ğ‘ )is defined for ğ‘ >0by the integral
ğ›¤(ğ‘ )=âˆ«âˆ
0ğ‘¡ğ‘ âˆ’1Â·ğ‘’âˆ’ğ‘¡ğ‘‘ğ‘¡.
2.2 Lattice Problems
Shortest Vector Problem (SVP) . Given a lattice basis B, the short-
est vector problem (SVP) is to find one shortest non-zero vector of
ğ¿(B).
Unique Shortest Vector Problem (uSVP) .Unique SVP problem is
for a given lattice ğ¿with promise of ğœ†1(ğ¿)â‰ªğœ†2(ğ¿), find a shortest
vector inğ¿.
Closest Vector Problem (CVP) . Given a basis Bof a latticeğ¿and
a target vector t, the closest vector problem asks to find a closest
vector bâˆˆğ¿(B), s.t.âˆ¥tâˆ’bâˆ¥â‰¤âˆ¥ tâˆ’vâˆ¥forâˆ€vâˆˆğ¿(B). We denote it
by CVP(t,B) in this paper.
Bounded Distance Decoding (BDD) . The definition of BDD( t,B)
is analogous but looser than CVP( t,B): with an additional condition
that there is bounded distance of length ğ‘‘from ttoğ¿(B), BDD asks
to find a lattice vector bs.t.âˆ¥tâˆ’bâˆ¥â‰¤ğ‘‘.
Learning With Errors (LWE) Problem [18] . Letğ·ğœdenote a
bounded distribution with standard deviation ğœ. Sample a matrix
AâˆˆZğ‘šÃ—ğ‘›ğ‘(ğ‘š,ğ‘›âˆˆZ)uniformly at random; and randomly sample
relatively small secret vector sâˆˆğ·ğ‘›ğœandeâˆˆğ·ğ‘šğœ. The pairs of
(A,bâ‰¡As+e(modğ‘))âˆˆZğ‘šÃ—ğ‘›ğ‘Ã—Zğ‘šğ‘are called as LWE samples.
TheLWE problem is for a given LWE sample (A,b), to compute the
pair(s,e).
Ring LWE (RLWE) Problem [17] . For ramdomly sampled poly-
nomialsğ‘âˆˆğ‘…ğ‘,ğ‘›,ğ‘ âˆˆğ‘…ğ‘,ğ‘›, andğ‘’whereğ‘’â€™s coeffients are sampled
fromğ·ğœ,(ğ‘,ğ‘=ğ‘Â·ğ‘ +ğ‘’âˆˆğ‘…ğ‘,ğ‘›)is called as a RLWE sample. The
RLWE problem is that given ğ‘ğ‘œğ‘™ğ‘¦(ğ‘›)number of RLWE samples of
(ğ‘,ğ‘), to findğ‘ (andğ‘’simultaneously).
2.3 Lattice Algorithms
Typically the above-introduced lattice problems can be reduced to
the SVP or uSVP. Namely, in some sense, doing cryptanalysis on the
lattice-based cryptoschemes is equivalent to analyzing the hardness
of reduced SVP or uSVP. One of the best-known lattice algorithms
isBKZ algorithm [20], which processes the given basis until being
almostğ›½-reduced. In other words, the projected lengths of each
basis vectors are the shortest ones in the relative ğ›½-dimensional
sub-lattice. BKZ costs exponentially in the blocksize ğ›½.In 2001, Ajtai et al. proposed a sieving algorithm to solve SVP [ 2].
It requires a runtime of 20.52ğ‘›+ğ‘œ(ğ‘›)in dimension ğ‘›and requires
exponential storage of 20.2ğ‘›+ğ‘œ(ğ‘›)as well. For a ğ›½-dimensional sub-
lattice the cost of sieving algorithm can be estimated in 20.292ğ›½+ğ‘œ(ğ›½)
operations. If we take sieving as a subroutine in the ğ›½-dimensional
sub-lattices inside of an ğ‘›-dimensional lattice, the total BKZ- ğ›½cost
can be estimated by 8ğ‘›Â·20.292ğ›½+12.31operations [ 5]. We recall the
following two definitions to evaluate the performance of lattice
algorithms.
Geometric Series Assumption (GSA) [19]. The geometric se-
ries assumption says that the norms of GSO vectors âˆ¥bâˆ—
ğ‘–âˆ¥in the
reduced basis decline geometrically with quotient ğ¹ğºğ‘†ğ´ such as
âˆ¥bâˆ—
ğ‘–âˆ¥2/âˆ¥bâˆ—
ğ‘–âˆ’1âˆ¥2=ğ¹ğºğ‘†ğ´ forğ‘–=1,...,ğ‘› andğ¹ğºğ‘†ğ´âˆˆ[3/4,1). Here
ğ¹ğºğ‘†ğ´ is called the GSA constant, whose size depends on the reduc-
tion algorithm and the corresponding parameter setting.
Root Hermite Factor (rHF) [10]. The root Hermite factor is de-
fined as:
ğ›¿=rHF(b1,..., bğ‘›)=(âˆ¥b1âˆ¥/Vol(ğ¿)1/ğ‘›)1/ğ‘›.
The rHF of a BKZ- ğ›½reduced basis Bofğ‘‘-dimensional lattice ğ¿(B)
can be evaluated by
ğ›¿=(((ğœ‹ğ›½)1/ğ›½ğ›½)/(2ğœ‹ğ‘’))1
2(ğ›½âˆ’1). (1)
This is proposed and practically verified by Chen in [9].
Generally, the quality of a lattice basis can be evaluated by ei-
ther the GSA constant ğ¹ğºğ‘†ğ´ or the rHF ğ›¿. Further, by a simple
computation, we can get ğ¹ğºğ‘†ğ´â‰ˆğ›¿âˆ’4whenğ‘›is large.
2016 Estimate [6]. The 2016 estimate for estimating the hardness
of LWE samples(A,bâ‰¡As+e(modğ‘))âˆˆZğ‘šÃ—ğ‘›ğ‘Ã—Zğ‘šğ‘states that
if the Gaussian heuristic and the GSA hold for BKZ- ğ›½reduced basis
andp
ğ›½/ğ‘‘Â·âˆ¥(e|1)âˆ¥â‰ˆp
ğ›½ğœâ‰¤ğ›¿2ğ›½âˆ’ğ‘‘Â·Vol(ğ¿(A,ğ‘))1/ğ‘‘, (2)
then error ecan be found by BKZ- ğ›½reduction algorithm. It has
been widely used in the cryptanalysis [ 21] for lattice-based cryp-
toschemes: given the dimension ğ‘‘, the modular ğ‘and the standard
deviationğœofeğ‘–â€™s distribution, the 2016 estimate can output the
optimal blocksize ğ›½in the attack, by using equations (1) and (2).
Algorithm 1 The nearest plane algorithm NP (t,B)to solve
CVP(t,B) [7].
Input: a basis Bofğ‘›-dimensional lattice ğ¿(ğµ), the target vector t;
Output: a vector bâˆˆğ¿(B)closest to t.
1:apply reduction algorithm to B;
2:compute the GSO basis Bâˆ—=(bâˆ—
1,..., bâˆ—ğ‘›) ofB;
3:bâ†t;
4:forğ‘–=ğ‘›,..., 1do
5:ğ‘¢ğ‘–=âŒˆâŸ¨b,bâˆ—
ğ‘–âŸ©/âŸ¨bâˆ—
ğ‘–,bâˆ—
ğ‘–âŸ©âŒ‹;
6: bâ†bâˆ’ğ‘¢ğ‘–bğ‘–;
7:end for
8:return b.
2.3.1 Nearest Plane Algorithm [ 7].We show the nearest plane al-
gorithm in Algorithm 1, which was proposed by Babai [ 7] to solve
the CVP( t,B) or BDD( t,B). The closest vector b=tâˆ’einğ¿(B)can
be successfully recovered if the entries of e=(ğ‘’1,...,ğ‘’ğ‘›)satisfy
âˆ’âˆ¥bâˆ—
ğ‘–âˆ¥/2<ğ‘’ğ‘–â‰¤âˆ¥bâˆ—
ğ‘–âˆ¥/2, (3)
Session 2
 
APKC '20, October 6, 2020, Taipei, Taiwan
30for1â‰¤ğ‘–â‰¤ğ‘›. For the sake of convenience, we denote the nearest
plane algorithm by NP (t,B). It runs in polynomial time in the input
size.
2.4 Key Construction of Giophantus Schemes
Now we review the construction of public and private keys in
Giophantus schemes. First, two polynomials ğ‘¢ğ‘¥(ğ‘¡),ğ‘¢ğ‘¦(ğ‘¡)inRğ‘™,ğ‘›
are randomly chosen. Then an irreducible bivariate polynomial
ğ‘‹(ğ‘¡,ğ‘¥,ğ‘¦)inRğ‘,ğ‘›[ğ‘¥,ğ‘¦]is sampled that it satisfies ğ‘‹(ğ‘¡,ğ‘¢ğ‘¥,ğ‘¢ğ‘¦)=0
inğ‘…ğ‘,ğ‘›. The public key and the private key are given as follows:
Public Key : ğ‘,ğ‘™,ğ‘›,ğ‘‹(ğ‘¡,ğ‘¥,ğ‘¦);
Private Key : ğ‘¢ğ‘¥(ğ‘¡),ğ‘¢ğ‘¦(ğ‘¡).
ğ‘Ÿ(ğ‘¡,ğ‘¥,ğ‘¦)âˆˆRğ‘,ğ‘›[ğ‘¥,ğ‘¦]andğ‘’(ğ‘¡,ğ‘¥,ğ‘¦)âˆˆRğ‘™,ğ‘›[ğ‘¥,ğ‘¦]are two perturba-
tions in encryption procedure. See [ 3] for the encryption/decreption
details of Giophantus schemes.
To make sure the decryption definitely succeed, ğ‘is set as
ğ‘>ğ‘™âˆ’1+ğ‘™ğ‘‘ğ‘’ğ‘”ğ‘¥,ğ‘¦ğ‘‹+ğ‘‘ğ‘’ğ‘”ğ‘¥,ğ‘¦ğ‘ŸÃ•
ğ‘˜=0(ğ‘˜+1)ğ‘›ğ‘˜(ğ‘™âˆ’1)(ğ‘˜+1)
in Giophantus,
ğ‘>2(âŒˆ(ğ‘™âˆ’1)/2âŒ‰+ğ‘™ğ‘‘ğ‘’ğ‘”ğ‘¥,ğ‘¦ğ‘‹+ğ‘‘ğ‘’ğ‘”ğ‘¥,ğ‘¦ğ‘ŸÃ•
ğ‘˜=0(ğ‘˜+1)ğ‘›ğ‘˜âŒˆ(ğ‘™âˆ’1)/2âŒ‰(ğ‘˜+1))
in Giophantusâˆ’, and
ğ‘>2(âŒˆğ‘™/2âŒ‰+ğ‘™ğ‘‘ğ‘’ğ‘”ğ‘¥,ğ‘¦ğ‘‹+ğ‘‘ğ‘’ğ‘”ğ‘¥,ğ‘¦ğ‘ŸÃ•
ğ‘˜=0(ğ‘˜+1)ğ‘›ğ‘˜âŒˆğ‘™/2âŒ‰ğ‘˜+1)
in Giophantus+, respectively. The large gap of ğ‘>25bits and
ğ‘™<4bits in practical settings result in uSVP instances in the
cryptanalysis of Giophantus cryptoschemes.
2.5 Key Recovery Attack on Giophantus
Akiyama et al. proposed two attacks in [ 3], the linear algebraic
attack (LAA) and the key recovery attack (KRA), by using the
lattice structure associated with Giophantus. Intuitively, in KRA the
public keyğ‘‹(ğ‘¡,ğ‘¥,ğ‘¦)is reduced to an RLWE sample where the secret
information and the perturbation are small. Giophantus schemes of
NIST PQC proposal and its variants adopt degğ‘¥,ğ‘¦ğ‘‹=1, thus we can
writeğ‘‹(ğ‘¡,ğ‘¥,ğ‘¦)=ğ‘(ğ‘¡)ğ‘¥+ğ‘(ğ‘¡)ğ‘¦+ğ‘(ğ‘¡). The coefficients ğ‘(ğ‘¡)ğ‘(ğ‘¡)ğ‘(ğ‘¡)
ofğ‘‹are all inğ‘…ğ‘,ğ‘›. Since gcd(ğ‘›,ğ‘)=1, the polynomials ğ‘¡ğ‘›âˆ’1and
ğ‘¡ğ‘›+1are square-free in ğ‘…ğ‘,ğ‘›. With a high probability, there exists
an inverse element in the ring ğ‘…ğ‘,ğ‘›. We suppose the inverse element
ofğ‘(ğ‘¡)exists and multiply ğ‘(ğ‘¡)âˆ’1toğ‘‹. We can get ğ‘‹â€²(ğ‘¡,ğ‘¥,ğ‘¦)=ğ‘¥+
ğ‘â€²(ğ‘¡)ğ‘¦+ğ‘â€²(ğ‘¡), while the solution of ğ‘‹â€²(ğ‘¡,ğ‘¥,ğ‘¦)=0is still(ğ‘¢ğ‘¥,ğ‘¢ğ‘¦)âˆˆ
ğ‘…ğ‘™,ğ‘›Ã—ğ‘…ğ‘™,ğ‘›with small coefficients. This is substantially an RLWE
sample of(ğ‘â€²(ğ‘¡),âˆ’ğ‘â€²(ğ‘¡)=ğ‘â€²(ğ‘¡)ğ‘¦+ğ‘¥)âˆˆğ‘…ğ‘,ğ‘›Ã—ğ‘…ğ‘,ğ‘›.
Next, we expand the available polynomials in RLWE sample to
vectors and matrix in LWE sample by the rotating operation, i.e. we
transform(ğ‘â€²(ğ‘¡),âˆ’ğ‘â€²(ğ‘¡)=ğ‘â€²(ğ‘¡)ğ‘¦+ğ‘¥)âˆˆğ‘…ğ‘,ğ‘›Ã—ğ‘…ğ‘,ğ‘›to(Bâ€²,câ€²=
Bâ€²y+x)âˆˆZğ‘›Ã—ğ‘›ğ‘Ã—Zğ‘›ğ‘. Particularly, Bâ€²is a square matrix because
only one RLWE sample is available in the attack to Giophantus
schemes. The latter LWE sample is related to a ğ‘-ary lattice:
ğ¿âŠ¥
((Iğ‘›Bâ€²âˆ’câ€²),ğ‘)={bâˆˆZğ‘š|(Iğ‘›Bâ€²âˆ’câ€²)bâ‰¡0(modğ‘)}.A basis Bofğ¿âŠ¥can be presented by
B=Â©Â­
Â«ğ‘Iğ‘›âˆ’Bâ€²câ€²
0 Iğ‘› 0
0 0 1ÂªÂ®
Â¬, (4)
since B(âˆ’k yT1)ğ‘‡=(xğ‘‡yğ‘‡1)ğ‘‡for some vector kâˆˆZğ‘›ğ‘.
Consequently, we can recover the small solution of (ğ‘¥,ğ‘¦)=
(ğ‘¢ğ‘¥,ğ‘¢ğ‘¦)by solving the uSVP in the ğ‘-ary latticeğ¿(B)of dimension
2ğ‘›+1, namely finding the shortest vector (xğ‘‡yğ‘‡1)which is esti-
mated much shorter than the second shortest vector by Gaussian
heuristic.
3 ORIGINAL HYBRID ATTACK
In this section, we first review Odlyzkoâ€™s Meet-in-the-Middle (MitM)
attack on binary uSVP instances. Then we recall Howgrave-Grahamâ€™s
hybrid attack [ 14] which combines MitM and lattice algorithms:
lattice reduction algorithm and the nearest plane algorithm.
3.1 Meet-in-the-Middle Attack
Odlyzkoâ€™s Meet-in-the-Middle attack on binary NTRU scheme [ 13]
is discussed in [15]. In NTRUâ€™s parameter settings, binary polyno-
mialsğ‘”,ğ‘“of degreeğ‘›âˆ’1are two private keys including ğ‘‘ğ‘”and
ğ‘‘ğ‘“ones respectively, and polynomial â„=ğ‘”/ğ‘“âˆˆğ‘…âˆ’ğ‘,ğ‘›(ğ‘âˆˆZ)is
the public key. The security of NTRU is based on the uSVP in the
2ğ‘›-dimensional lattice ğ¿constructed by a basis B=ğ‘Iğ‘›H
0 Iğ‘›
, since
for some integer vectork
f
, we have
ğ‘Iğ‘›H
0 Iğ‘› k
f
=g
f
,
where His a circulant matrix generated from â„, i.e.Hğ‘–,ğ‘—=â„ğ‘–+ğ‘—modğ‘›.
The basis Bis called as an NTRU basis in the literature. Due to the
property such as(ğ‘“ğ‘¥ğ‘–)â„=ğ‘”ğ‘¥ğ‘–in the ring ğ‘…âˆ’ğ‘,ğ‘›,(gT,fT)and its
rotations(g(ğ‘–)T,f(ğ‘–)T)are all the solutions, where g(ğ‘–)andf(ğ‘–)are
vectors of coefficients in ğ‘”ğ‘¥ğ‘–andğ‘“ğ‘¥ğ‘–respectively. The determinant
det(ğ¿(B))=ğ‘ğ‘›and the norm of solutions isq
ğ‘‘ğ‘“+ğ‘‘ğ‘”; therefore,
(gT,fT)and its rotations are expected to be the shortest vector,
which are much shorter than other vectors, in ğ¿(B)by the Gaussian
heuristic. Namely, to recover the binary private key of NTRU is
equivalent to solve the uSVP in ğ¿(B).
Assume that ğ‘‘ğ‘“is even. In the MitM attack, we divide the secret
polynomial ğ‘“byğ‘“=ğ‘“1+ğ‘“2, withğ‘‘ğ‘“/2ones inğ‘“1â€™s coefficients.
Then the coefficients of ğ‘¦1=ğ‘“1â„andğ‘¦2=ğ‘“2â„differ only by 0or1
becauseğ‘¦1+ğ‘¦2=ğ‘”. The attacker randomly sample ğ‘“1and compute
ğ‘¦1=ğ‘“1â„. The polynomial ğ‘“1is then stored into boxes addressed by
1â—‹binary strings ğ‘ğ‘–=ğ›½1:ğ›½2:Â·Â·Â·:ğ›½ğ‘›, whereğ›½ğ‘—=ğ›½ğ‘—(ğ‘¦1)=1if
(ğ‘¦1)ğ‘—>0and0otherwise; 2â—‹binary strings Â¯ğ‘ğ‘–=Â¯ğ›½1:Â¯ğ›½2:Â·Â·Â·:Â¯ğ›½ğ‘›
where Â¯ğ›½ğ‘—=1âˆ’ğ›½ğ‘—. Becauseğ‘¦1=âˆ’ğ‘¦2+ğ‘”andğ‘”is binary, with high
probability we can get ğ›½ğ‘—(ğ‘¦1)=ğ›½ğ‘—(âˆ’ğ‘¦2+ğ‘”)=1âˆ’ğ›½ğ‘—(ğ‘¦2), ifğ‘”does
not change the sign. Thus one pair of (ğ‘“1,ğ‘“2)of the solution ğ‘“are
expected to be in the same box addressed by ğ‘1and Â¯ğ‘2. Here we
can storeğ‘“1into more boxes for the cases that ğ‘”changes the sign of
ğ›½(âˆ’ğ‘¦2+ğ‘”). Accordingly, if there are already polynomial ğ‘“2inside
Session 2
 
APKC '20, October 6, 2020, Taipei, Taiwan
31Figure 1: GSA observation. Given a 250-dimensional NTRU
basis B, we apply the BKZ-20 reduction algorithm to 190-
dimensional (blue line) and 170-dimensional (red line) sub-
lattice ofğ¿(B), respectively.
of the corresponding box, then after sampling ğ‘“1the attacker check
if(ğ‘“1+ğ‘“2)â„is binary (correct solution) or not.
The expected number of loops of MitM attack on binary NTRU
is1âˆšğ‘›ğ‘›
ğ‘‘ğ‘“/2 ğ‘‘ğ‘“
ğ‘‘ğ‘“/2âˆ’1/2
. Simultaneously, the storage requirement
for the above boxes is exponentially large.
3.2 Hybrid Attack
Assume that we are given an ğ‘-dimensional NTRU basis Brepre-
sented in subsection 3.1 ( ğ‘=2ğ‘›). By applying the BKZ- ğ›½reduction
algorithm to a sub-lattice of ğ¿(B), we get a reduced basis of
D=BU=Â©Â­
Â«ğ‘Iğ‘Ÿâˆ— âˆ—
0 Dâ€²âˆ—
0 0 I ğ‘Ÿâ€²ÂªÂ®
Â¬âˆˆZğ‘Ã—ğ‘,
where Uis a unimodular matrix, ğ‘š+ğ‘Ÿâ€²=ğ‘andDâ€²âˆˆZ(ğ‘šâˆ’ğ‘Ÿ)Ã—(ğ‘šâˆ’ğ‘Ÿ).
Here in Figure 1, we show an experimental result that the distribu-
tion of Dâ€™s GSO vectors obeys GSA in subsection 2.3 very well.
In addition, we take QR-decomposition on Dand get
Â©Â­
Â«Iğ‘Ÿ0 0
0 Yâ€²0
0 0 Iğ‘Ÿâ€²ÂªÂ®
Â¬D=Â©Â­
Â«ğ‘Iğ‘Ÿâˆ— âˆ—
0 Tâ€²âˆ—
0 0 I ğ‘Ÿâ€²ÂªÂ®
Â¬(5)
which is denoted by YD=T, where
Yâ€²=(dâ€²âˆ—
1/âˆ¥dâ€²âˆ—
1âˆ¥,..., dâ€²âˆ—
ğ‘šâˆ’ğ‘Ÿ/âˆ¥dâ€²âˆ—
ğ‘šâˆ’ğ‘Ÿâˆ¥)
and
Tâ€²=Â©Â­Â­Â­Â­
Â«âˆ¥dâ€²âˆ—
1âˆ¥ğœ‡2,1âˆ¥dâ€²âˆ—
1âˆ¥ Â·Â·Â·ğœ‡ğ‘šâˆ’ğ‘Ÿ,1âˆ¥dâ€²âˆ—
1âˆ¥
0âˆ¥dâ€²âˆ—
2âˆ¥ Â·Â·Â·ğœ‡ğ‘šâˆ’ğ‘Ÿ,2âˆ¥dâ€²âˆ—
2âˆ¥
............
0 0Â·Â·Â· âˆ¥ dâ€²âˆ—
ğ‘šâˆ’ğ‘Ÿâˆ¥ÂªÂ®Â®Â®Â®
Â¬.Algorithm 2 Original Hybrid Attack on uSVP with Binary Solu-
tion [14]
Input: a basis Bofğ‘-dimensional q-ary lattice ğ¿(ğµ),ğ‘šâˆˆN;
Output: a binary vector bâˆˆğ¿(B)withğ‘ones andğ‘âˆ’ğ‘zeros in
b;
1:while truedo
2: apply reduction algorithm to the first ğ‘švectors in Band get
Tby QR-decomposition;
3: guess a binary vector v1of lengthğ‘Ÿâ€²=ğ‘âˆ’ğ‘šwithâŒˆğ‘Ÿâ€²Â·ğ‘/ğ‘âŒ‹
ones;
4: calculatex1
0
=NP
T0
v1
âˆ’0
v1
,T
;
5: store v1in all the boxes addressed by A(ğ‘Ÿ)
x1âˆªA(ğ‘Ÿ)
âˆ’x1;
6: forallv2â‰ v1in the above boxes do
7: letv=v1+v2and calculatex
0
=NP
T0
b
âˆ’0
b
,T
;
8: ifb=Yâˆ’1x
v
is binary then
9: return b;
10: end if
11: end for
12:end while
Denote by da shortest binary vector in ğ¿(D)=ğ¿(BU)=ğ¿(B).
We separate the vectors as
Yd=s
v
=Tu
v
(6)
where u,sandvare of lengths ğ‘šandğ‘Ÿâ€²=ğ‘âˆ’ğ‘š, respectively. The
hybrid attack works on the righthand of equation (6) to get the
solution d.
Lemma 1 ([ 14], lemma 2). The vector T0
v
âˆ’0
v
is close to a
lattice point in ğ¿(T)with a distance ofâˆ¥sâˆ¥.
Proof.
T0
v
âˆ’0
v
=Tu
v
âˆ’Tu
0
âˆ’0
v
=s
0
âˆ’Tu
0
.
â–¡
The vectors
0
can be found successfully by Algorithm 1 if it
satisfies the condition of (3).
A part v1ofv=v1+v2is expected to be guessed in the hybrid
attack. v1is calledğ‘ -admissible if
T0
v1
âˆ’0
v1
=x1
0
âˆ’Tu1
0
T0
v1
âˆ’s
v1
=x1âˆ’s
0
âˆ’Tu1
0 (7)
where x1andu1are computed via Algorithm 1.
Namely,s
0
is small enough that it can not affect the output of
Session 2
 
APKC '20, October 6, 2020, Taipei, Taiwan
32NP
T0
v1
âˆ’0
v1
,ğ¿(T)
. In particular, if v1isğ‘ -admissable, then
v2is alsoğ‘ -admissable (refer to lemma 5 and its proof in [ 14]). To
store the sampled vector v1, the binary-addressed boxes associated
with x1are defined as follows. We note that by abuse of notation,
in the following two definitions, we denote by ağ‘–(and xğ‘–) theğ‘–-th
element of the vector a(and x, respectively).
Definition 2 ([ 14], definition 2). Forğ‘ŸâˆˆNand any vector
xâˆˆZğ‘šğ‘, we define a setA(ğ‘Ÿ)
xofğ‘Ÿ-bit integer addresses:
A(ğ‘Ÿ)
x=
aâˆˆ{0,1}ğ‘Ÿağ‘–=1 ifxğ‘–>1
ağ‘–=0 ifxğ‘–â‰¤0forğ‘–âˆˆ[1,ğ‘Ÿ]
.
Furthermore, the following defined boxes can handle arbitrary
vectors v1rather than binary.
Definition 3 ([ 22], definition 1). Letğ‘¦=âˆ¥vâˆ¥âˆand all other
parameters are the same as which in Definition 2. The extended boxes
A(ğ‘Ÿ)
xis defined as:
A(ğ‘Ÿ)
x=
aâˆˆ{0,1}ğ‘Ÿağ‘–=1 ifxğ‘–>âŒˆğ‘¦
2âˆ’1âŒ‰
ağ‘–=0 ifxğ‘–<âˆ’âŒŠğ‘¦
2âŒ‹forğ‘–âˆˆ[1,ğ‘Ÿ]
.
We show the hybrid attack in Algorithm 2. The success proba-
bility of the hybrid attack depends on two aspects:
(i) The probability ğ‘ğ‘ that the sampled vector v1isğ‘ -admissible.
(ii) The probability ğ‘â„that the sampled v1is definitely part of the
correct solution, i.e. v1=vâˆ’v2for some vector v2.
We will discuss the calculation of these two probability in section 4.
Letğ‘‰denote the set of ğ‘ -admissible vectors v1. A collision of
the same address is expected to occur after around |ğ‘‰|1/2samples.
Consequently, the loop of Algorithm 2 is
ğ¿#:=(ğ‘ğ‘ Â·ğ‘â„)âˆ’1|ğ‘‰|1/2. (8)
This hybrid attack requires storage complexity of ğ‘‚(ğ¿#). To esti-
mate the cost of an optimal hybrid attack, it is important to evaluate
the parameters so as to handle the trade-off between reduction al-
gorithm and MitM attack. In the next section, we propose such a
simulator for the hybrid attack.
4 OUR PROPOSED SIMULATOR
In this section, we propose a feasible simulator that can dynam-
ically estimate the cost of a hybrid attack, taking into account
trade-off between the cost of exponential lattice reduction and
exponential MitM attack. We then apply the simulator to Giophan-
tus, Giophantus+and Giophantusâˆ’, by reducing their underlying
Diophantine equation to the unique shortest vector problem.
4.1 A Simulator of Hybrid Attack
We show our simulator in Algorithm 3 and explain how it works.
The goal of this simulator is to estimate the minimal practical cost
of hybrid attack on the uSVP in a ğ‘-ary lattice ğ¿(B). Assume the
shortest vector is b=(b1,..., bğ‘), whereğ‘is the dimension of
ğ¿(B). Denote by ğœthe standard deviation of bğ‘–â€™s distribution ğ·ğ‘ğœ.
By a simple computation using Gaussian heuristic, finding binğ¿(B)
is certainly a uSVP instance when given ğœis small and ğ‘is large.
The inputs for our simulator are (ğ‘,ğ‘,ğœ)and a bound[ğ‘š1,ğ‘š2]
for the dimension of the sub-lattice in the reduction part, where
âŒˆğ‘/2âŒ‹<ğ‘š1<ğ‘š2<ğ‘.Algorithm 3 Simulator to estimate the optimal hybrid attack cost.
Input: dimensionğ‘ofğ¿(B), modulusğ‘, standard deviation ğœ,
and bound of dimension of sublattice ğ‘šâˆˆ[ğ‘š1,ğ‘š2];
Output: minimum total cost ğ¶and the corresponding optimal ğ‘Ÿâ€²,
ğ›½in the hybrid attack on ğ¿(B).
1:ğ›½=ğ›½1â†2016 estimate using ğ‘,ğ‘,ğœ ;
2:whileğ›½1âˆ’100<ğ›½<ğ›½1do
3:ğ‘š=ğ‘š2,ğ‘–=1,ğ¶=âˆ;
4: whileğ‘š>ğ‘š1do
5:ğ›¿â†equation (1);
6:(ğ‘Ÿ,ğ›¼)â† equations (9) and (10);
7: ifğ›¼â‰¤0then
8: move to step 21;
9: end if
10:ğ¶BKZâˆ’ğ›½=8(ğ‘šâˆ’ğ‘Ÿ)Â·20.292ğ›½+12.31;
11:ğ¶ğ‘€ğ‘–ğ‘¡ğ‘€â†equation (11);
12:ğ¶ğ‘¡ğ‘šğ‘=ğ¶BKZâˆ’ğ›½+ğ¶ğ‘€ğ‘–ğ‘¡ğ‘€ ;
13: ifğ¶>ğ¶ğ‘¡ğ‘šğ‘then
14:ğ¶=ğ¶ğ‘¡ğ‘šğ‘,ğ‘–=1;
15: else
16:ğ‘–=ğ‘–+1;
17: end if
18: ifğ‘–>40then
19: move to step 23; //terminate heuristically
20: end if
21:ğ‘š=ğ‘šâˆ’1;
22: end while
23:ğ›½=ğ›½âˆ’1;
24:end while
25:returnğ¶,ğ‘Ÿâ€²,ğ›½.
First, we generate an upper bound ğ›½1by the 2016 estimate, for
the required blocksize when applying the BKZ reduction to the full
basis B. Note that we heuristically test from ğ›½1âˆ’100toğ›½1(step 2)
in our simulator, which experientially cover the possible optimal ğ›½.
We assume that Bis reduced to a new basis Dby BKZ-ğ›½algorithm.
The QR-decomposition of Dis the same as equation (5), where the
firstğ‘Ÿâ€²vectors are of norm ğ‘, the lastğ‘Ÿvectors are of norm 1, and
there areğ‘Ÿğ‘Œ:=ğ‘âˆ’ğ‘Ÿâˆ’ğ‘Ÿâ€²vectors at the rest middle part. Denote
byğ‘š=ğ‘Ÿâ€²+ğ‘Ÿğ‘Œthe dimension of the sub-lattice being reduced. For
the sake of convenience, we show the hybrid model in Figure 2.
In our simulator, we use the assumption of GSA and the property
that the volume of lattice does not change during the reduction, i.e.
logğ‘T2
ğ‘š,ğ‘šâˆ’logğ‘ğ‘2=logğ‘ğ¹ğ‘šâˆ’ğ‘Ÿ
ğºğ‘†ğ´
and
ğ‘ğ‘Ÿğ‘šÃ–
ğ‘–=ğ‘Ÿ+1ğ‘ğ‘’ğ‘–=ğ‘ğ‘›,
respectively. Set ğ›¼=logğ‘Tğ‘š,ğ‘š and substitute ğ¹ğºğ‘†ğ´=ğ›¿âˆ’4into
above equations, we have
ğ‘Ÿ=ğ‘šâˆ’&s
(ğ‘šâˆ’ğ‘›)
logğ‘ğ›¿%
(9)
ğ›¼=1+2âˆ—(ğ‘Ÿâˆ’ğ‘š)Â·logğ‘ğ›¿. (10)
Session 2
 
APKC '20, October 6, 2020, Taipei, Taiwan
33Figure 2: A model of hybrid attack.
Then the cost ğ¶BKZ-ğ›½of the BKZ reduction part can be computed
easily at step 10. To evaluate the cost ğ¶MitM of the MitM, we should
carefully calculate the two probability introduced in subsection 3.2:
ğ‘ğ‘ of sampling v1ağ‘ -admissible vector; and ğ‘â„thatv1is part of
the correct solution.
To compute the former ğ‘ğ‘ , we refer to the methodology used
in [14]. Namely, we reduce the problem of estimating ğ‘ğ‘ to the
problem of evaluating the probability distribution of coordinates
ğ›¾ğ‘–ofsâ€²=Yâ€²gâ€²where Yâ€²âˆˆR(ğ‘šâˆ’ğ‘Ÿ)Ã—(ğ‘šâˆ’ğ‘Ÿ)is orthonormal matrix as
defined in subsection 3.2, and separate the solution as (gğ‘‡fğ‘‡)=
(gğ‘‡ğ‘Ÿgâ€²ğ‘‡fâ€²ğ‘‡). We assume the expected norm of gâ€²isğ‘‘, thusâˆ¥gâ€²âˆ¥âˆâ‰¤
ğ‘‘, i.e.|ğ›¾ğ‘–| â‰¤ğ‘‘forğ‘Ÿ+1â‰¤ğ‘–â‰¤ğ‘šâˆ’ğ‘Ÿ. Denote by ğ‘ğ‘‘(ğœƒ,ğœƒâ€²)the
probability that ğœƒâ‰¤|ğ›¾ğ‘–|<ğœƒâ€²and we divide the interval [0,ğ‘‘]into
ğ¾sections as 0=ğœƒ1<ğœƒ2<Â·Â·Â·<ğœƒğ¾=ğ‘‘. Then we have
ğ‘ğ‘ >
1âˆ’1
ğ‘ğ‘Ÿ/2ğ‘šÃ–
ğ‘–=ğ‘Ÿ+1 ğ¾âˆ’1Ã•
ğ‘˜=1
1âˆ’ğœƒğ‘˜+1
ğ‘ğ‘’ğ‘–
ğ‘ğ‘‘(ğœƒğ‘˜,ğœƒğ‘˜+1)!
ğ‘ğ‘ <
1âˆ’1
ğ‘ğ‘Ÿ/2ğ‘šÃ–
ğ‘–=ğ‘Ÿ+1 ğ¾Ã•
ğ‘˜=1
1âˆ’ğœƒğ‘˜
ğ‘ğ‘’ğ‘–
ğ‘ğ‘‘(ğœƒğ‘˜,ğœƒğ‘˜+1)!
Hereğ‘’ğ‘–=((ğ›¼âˆ’1)ğ‘–+(ğ‘šâˆ’ğ›¼ğ‘Ÿ))/(ğ‘šâˆ’ğ‘Ÿ)is calculated by GSA.
Meanwhile, depending on different distributions of the solution, ğ‘â„
should be calculated case by case. We show how to compute ğ‘â„in
the analysis of Giophantus cryptoschemes in subsection 4.2.
If the solution in Algorithm 3 is an arbitrary vector binstead of
the binary one, it is suggested to sample the elements of v1from
[âˆ’ğ‘˜,ğ‘˜]whereğ‘˜=âˆ¥bâˆ¥âˆ[22]. However, due to the computation
result in Table 1, sampling v1from[âˆ’âŒˆğ‘˜/2âŒ‹,âŒˆğ‘˜/2âŒ‹]seems more
practical according to a calculation for Giophantus key recovery
attack.
Moreover, the orthonormal matrix Yâ€²can be generated from a
random matrix Bby QR-decomposition. We test how the different
types of BâˆˆZ(ğ‘šâˆ’ğ‘Ÿ)Ã—(ğ‘šâˆ’ğ‘Ÿ)
ğ‘ can affect on the results of ğ‘ğ‘ : using the
original sampled basis BinZ100Ã—100ğ‘ by modulus ğ‘=761, applying
LLL and BKZ reduction algorithms to B, and sampling Bby larger
modulusğ‘=695069. For each case, we repeat 1000 times and takev1âˆˆ{âˆ’1,0,1,2}v1âˆˆ{âˆ’1,0,1}
#Loops(ğ‘Ÿâ€²=120)Â·âˆšğ‘ğ‘  130.6 121.5
#Loops(ğ‘Ÿâ€²=200)Â·âˆšğ‘ğ‘  221.4 206.7
Table 1: Analyze the pattern to sample v1for hybrid attack
on Giophantus. Sampling v1from[âˆ’âŒˆğ‘˜/2âŒ‹,âŒˆğ‘˜/2âŒ‹]makes the
attack more efficient.
the average value. The experimental results in Figure 3 show that
ğ‘ğ‘‘(ğœƒ,ğœƒâ€²)are close to each other. For this reason, we can generate
Yâ€²from a random BâˆˆZ(ğ‘šâˆ’ğ‘Ÿ)Ã—(ğ‘šâˆ’ğ‘Ÿ)
ğ‘ with a small ğ‘.
Figure 3: Test ğ‘ğ‘ with respect to different types of bases in
Z100Ã—100ğ‘ used in the simulator. The size of modulus ğ‘and
the type of bases almost do not affect evaluating ğ‘ğ‘ .
After preparing the above two probability, we can compute the
number of loops ğ¿#for the guessing part by equation (8). Further-
more, in each loop, the candidates in the boxes are checked by
multiplying Yâˆ’1. Hence we estimate the total cost for the part of
MitM attack by
ğ¶ğ‘€ğ‘–ğ‘¡ğ‘€ =ğ‘š2ğ¿#. (11)
Note that this estimation is conservative. Consequently, we can
test the total cost ğ¶of the hybrid attack dynamically for each
ğ›½1âˆ’100<ğ›½<ğ›½1andğ‘š1<ğ‘š<ğ‘š2. Incidentally, we terminate
the loop heuristically at step 19 when there is no smaller cost arises
after 40 iterations.
4.2 Cryptanalysis on Giophantus and its
Variants
As we introduced in subsection 2.5, one can recover the private key
(ğ‘¢ğ‘¥,ğ‘¢ğ‘¦)âˆˆRğ‘™,ğ‘›Ã—Rğ‘™,ğ‘›of Giophantus cryptoschemes via solving
a uSVP in Giophantus matrix (4) in Z(2ğ‘›+1)Ã—( 2ğ‘›+1)
ğ‘ becauseğ‘™=4
andğ‘â‰«ğ‘™are used in the proposals. We apply our hybrid attack
simulator to analyze the parameters proposed in Giophantus [ 3],
Giophantus+[16] and Giophantusâˆ’[4], respectively. Although the
coefficients of the secret polynomial are in the set of {âˆ’1,0,1,2},
we sample the coordinates of v1in{âˆ’1,0,1}due to the analysis in
Session 2
 
APKC '20, October 6, 2020, Taipei, Taiwan
34schemes (ğ‘›,ğ‘)claimed security parameters in hybrid attack
levels (bits) ğ‘Ÿğ‘Ÿğ‘Œğ‘Ÿâ€²ğ›½ğ›¼ log2(ğ¿ğ‘€)log2(ğ¶ğ‘€)log2(ğ¶ğµğ¾ğ‘)log2(ğ¶ğ»)
Giophantus(1201, 467424413) 143 51 2296 56 352 0.002 104.1 126.5 129.3 129
(1733, 973190461) 207 82 3301 84 560 0.0004 156.1 190.5 179.6 191
(2267, 1665292879) 272 121 4286 128 774 0.0015 219.3 243.5 253.4 253
Giophantus+ (2048, 805445633) 207 132 3831 134 696 0.0005 226.6 250.5 230.4 251
(4096, 3221544961) 272 *
Giophantusâˆ’(1297, 323067169) 143 56 2481 58 404 0.0004 117.6 140.3 144.6 145
(1847, 655108841) 207 100 3491 104 622 0.0011 181.4 205 208.7 209
(2357, 1066797089) 272 136 4441 138 834 0.0004 243.9 268.2 271 272
Table 2: Results of cryptanalysis against hybrid attack. The hybrid attack can reduce the security of Giophantus proposed
parameters, while the parameters of Giphantus+and Giophantusâˆ’are secure.
Table 1. Besides,
ğ‘â„=12ğ‘Ÿâ€²/4ğ‘Ÿâ€²
ğ‘1ğ‘Ÿâ€² ğ‘Ÿâ€²âˆ’ğ‘1ğ‘Ÿâ€²
ğ‘2ğ‘Ÿâ€² ğ‘Ÿâ€²âˆ’ğ‘1ğ‘Ÿâ€²âˆ’ğ‘2ğ‘Ÿâ€²
ğ‘3ğ‘Ÿâ€²âˆ’1
,
forğ‘1=5/24,ğ‘2=1/3,ğ‘3=11/24.
We show the simulation results in Table 2. It is known in all the
cases thatğ‘=2ğ‘›+1and the standard deviation of the solution
isğœ=1.12.(ğ‘›,ğ‘)are the proposed parameter sets. The â€œclaimed
security levelsâ€correspond to the security categories of NIST PQC
standardization project, e.g. breaking the AES-128 security requires
attackersâ€™ efforts of 143 bits operations at least. We also show the
optimal parameters and the costs for each part in the hybrid attack.
In particular, the final total cost of ğ¶ğ»indicates that the security
levels of Giophantus are expected to be reduced by at most 19 bits
using the hybrid attack. Simultaneously, the claimed security levels
for Giophantus+and Giophantusâˆ’are ensured against the hybrid
attack.
5 CONCLUSION
In this paper, we proposed a hybrid attack simulator against the
unique Shortest Vector Problem (uSVP). Our algorithm can trade
off the cost between the lattice reduction part and the guessing
part of MitM attack. Our simulation results for the cryptoschemes
Giophantus [ 3], Giophantus+[16] and Giophantusâˆ’[4] show that
by the hybrid attack, the security level is reduced by at most 19
bits for Giophantusâ€™ parameters proposed in NIST Post Quantum
Cryptography (PQC) standardization 1st round submission, and the
parameter sets of Giophantus+and Giophantusâˆ’are secure against
the hybrid attack.
ACKNOWLEDGMENTS
This work was supported by JSPS KAKENHI Grant Number 19F19378,
19K20266, JST CREST Grant Number JPMJCR14D6, Japan.
REFERENCES
[1]US Department of Commerce, National Institute of Standards and Technology.
Post-Quantum Cryptography, 2019. https://csrc.nist.gov/projects/post-quantum-
cryptography/.
[2]M. Ajtai, R. Kumar, and D. Sivakumar. A sieve algorithm for the shortest lattice
vector problem. In Proceedings of the Thirty-third Annual ACM Symposium on
Theory of Computing, pages 601â€“610, 2001.
[3]K. Akiyama, Y. Goto, S. Okumura, T. Takagi, K. Nuida, and G. Hanaoka. A public-
key encryption scheme based on non-linear indeterminate equations. In Selected
Areas in Cryptography - SAC 2017 - 24th International Conference, Revised Selected
Papers, pages 215â€“234, 2017.[4]K. Akiyama, Y. Wang, Y. Ikematsu, and T. Takagi. A study on a variant of
indeterminate equation public-key cryptosystems assuming one-wayness. In
SCIS 2020, 2020.
[5]M. R. Albrecht, R. Player, and S. Scott. On the concrete hardness of learning with
errors. Journal of Mathematical Cryptology, 9(3):169â€“203, 2015.
[6]E. Alkim, L. Ducas, T. PÃ¶ppelmann, and P. Schwabe. Post-quantum key exchange-
a new hope. In USENIX Security Symposium, pages 327â€“343, 2016.
[7]L. Babai. On lovÃ¡szâ€™ lattice reduction and the nearest lattice point problem (short-
ened version). In STACS 85, 2nd Symposium of Theoretical Aspects of Computer
Science, Proceedings, pages 13â€“20, 1985.
[8]J. A. Buchmann, F. GÃ¶pfert, R. Player, and T. Wunderer. On the hardness of
LWE with binary error: Revisiting the hybrid lattice-reduction and meet-in-the-
middle attack. In Progress in Cryptology - AFRICACRYPT 2016 - 8th International
Conference on Cryptology in Africa, Proceedings, pages 24â€“43, 2016.
[9]Y. Chen. Lattice reduction and concrete security of fully homomorphic encryption.
Dept. Informatique, ENS, Paris, France, PhD thesis, 2013.
[10] N. Gama and P. Q. Nguyen. Predicting lattice reduction. In Advances in Cryptology
- EUROCRYPT 2008, 27th Annual International Conference on the Theory and
Applications of Cryptographic Techniques, Proceedings, pages 31â€“51, 2008.
[11] F. GÃ¶pfert, C. van Vredendaal, and T. Wunderer. A hybrid lattice basis reduc-
tion and quantum search attack on LWE. In Post-Quantum Cryptography - 8th
International Workshop, PQCrypto 2017, Proceedings, pages 184â€“202, 2017.
[12] P. S. Hirschhorn, J. Hoffstein, N. Howgrave-Graham, and W. Whyte. Choos-
ing ntruencrypt parameters in light of combined lattice reduction and MITM
approaches. In Applied Cryptography and Network Security, 7th International
Conference, ACNS 2009, Proceedings, pages 437â€“455, 2009.
[13] J. Hoffstein, J. Pipher, and J. H. Silverman. NTRU: A ring-based public key
cryptosystem. In Algorithmic Number Theory, Third International Symposium,
ANTS-III, Proceedings, pages 267â€“288, 1998.
[14] N. Howgrave-Graham. A hybrid lattice-reduction and meet-in-the-middle at-
tack against NTRU. In Advances in Cryptology - CRYPTO 2007, 27th Annual
International Cryptology Conference, Proceedings, pages 150â€“169, 2007.
[15] N. Howgrave-Graham, J. Silverman, and W. Whyte. A meet-in-the-middle at-
tack on an ntru private key. 2003. Available at https://www.researchgate.net/
publication/2906622.
[16] Y. Ikematsu, Y. Wang, K. Akiyama, and T. Takagi. Experimental analysis for linear
algebraic attack on a variant of indeterminate equation public-key cryptosystems.
InSCIS 2019, 2019.
[17] V. Lyubashevsky, C. Peikert, and O. Regev. On ideal lattices and learning with
errors over rings. In Advances in Cryptology - EUROCRYPT 2010, 29th Annual In-
ternational Conference on the Theory and Applications of Cryptographic Techniques,
Proceedings, pages 1â€“23, 2010.
[18] O. Regev. On lattices, learning with errors, random linear codes, and cryptography.
J. ACM, 56(6):34:1â€“34:40, 2009.
[19] C. Schnorr. Lattice reduction by random sampling and birthday methods. In
STACS 2003, 20th Annual Symposium on Theoretical Aspects of Computer Science,
Proceedings, pages 145â€“156, 2003.
[20] C. Schnorr and M. Euchner. Lattice basis reduction: Improved practical algorithms
and solving subset sum problems. Math. Program., 66:181â€“199, 1994.
[21] Y. Wang, Y. Aono, and T. Takagi. An experimental study of kannanâ€™s embedding
technique for the search LWE problem. In Information and Communications
Security - 19th International Conference, ICICS 2017, Proceedings, pages 541â€“553,
2017.
[22] T. Wunderer. Revisiting the hybrid attack: Improved analysis and refined security
estimates. IACR Cryptology ePrint Archive, 2016:733, 2016.
Session 2
 
APKC '20, October 6, 2020, Taipei, Taiwan
35